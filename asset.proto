syntax = "proto3";

package asset;

import "google/protobuf/timestamp.proto";
import "sologenic/com-fs-utils-lib/models/metadata/metadata.proto";

option go_package = "github.com/sologenic/com-fs-asset-model;asset";

message Asset {
    // Key combination: Currency-OrganizationID-Version (Symbol-Version)
    string ID = 1; // Key string to prevent composing the key all the time and reduce errors
    string OrganizationID = 2; // External entity (broker) that owns this asset, e.g. issuer
    AssetStatus Status = 3;
    optional Reason Reason = 4;
    repeated string JurisdictionIDs = 5; // list of jurisdictionIDs where this asset is allowed to be traded
    metadata.Network Network = 6;
    google.protobuf.Timestamp CreatedAt = 7;
    google.protobuf.Timestamp UpdatedAt = 8;
    AssetType Type = 9;

    // Flattened StockProperties
    string Symbol = 10; // Currency-OrganizationID(issuer) 
    string Currency = 11;
    string Version = 12;
    int32 Precision = 13;
    string Name = 14; // TODO: temp. solution: `Name` will be used to build the subunit as a Symbol in the smart contract, {Name}_v{Version}
    string ExchangeTickerSymbol = 15;
    string Exchange = 16;
    string Description = 17;
    string MinTransactionAmount = 21;
    string ExtraPercentage = 22; // extra margin % that the buyer must provide when buying an asset ( "1" = 100%, 0.1 = 10%, ...) and cost will be half of the extra margin
    // e.g ExtraPercentage = "0.1" means the buyer must provide 10% extra margin when buying an asset and the cost will be 5% of the extra margin, and rest 5% will be returned to the buyer

    // Denomination in the Smart Contract
    // {Symbol}_v{Version}-{SmartContract addr} where Symbol is the symbol in the smart contract, not Symbol in the Asset object
    // - is not allwed in symbol in the coreum smart contract: https://github.com/CoreumFoundation/coreum/blob/e5f74cfa51e3a83d101c0a307af18378c18d4748/x/asset/ft/types/token.go#L21
    // e.g. "btc_v1-testcore1et29cek95pl0zralsf43u4uply0g9nmxnj7fyt9yfy74spch7fpq3f8j0e"
    // Alternatively, we can use Name field to build the subunit in the smart contract, {Name}_v{Version}, that is, `Name` (in the Asset) == `Symbol` (in the smart contract)
    string Denom = 18;
    string SmartContractAddress = 19;
    bool IsIssuedInSmartContract = 20; // Flag to indicate if the asset is issued in the smart contract
}

message Assets {
    repeated Asset Assets = 1;
}

message UserAssetList {
    // Key combination: Currency-OrganizationID-Version-AccountID-Wallet (AssetKey-AccountID-Wallet)
    string AccountID = 1;
    string Wallet = 2;
    string AssetKey = 3; // Stable Key: "Currency-OrganizationID-Version"
    UserAssetStatus Status = 4;
    metadata.Network Network = 5;
    bool Visible = 6;
    google.protobuf.Timestamp CreatedAt = 7;
    google.protobuf.Timestamp UpdatedAt = 8;
}

message UserAssetLists {
    repeated UserAssetList UserAssetLists = 1;
}

enum AssetStatus {
    ASSET_STATUS_DO_NOT_USE = 0;
    DO_NOT_LIST = 1; // BROKER_ASSET_ADMINISTRATOR only
    REQUEST_LISTING = 2; // BROKER_ASSET_ADMINISTRATOR only
    LISTED = 3; // ORGANIZATION_ASSET_ADMINISTRATOR only
    ORGANIZATION_ADMIN_DO_NOT_LIST = 4; // ORGANIZATION_ASSET_ADMINISTRATOR only
    OUTDATED_ASSET_VERSION = 5;
}

enum Reason {
    REASON_DO_NOT_USE = 0;
    DUPLICATE = 1;
    UNWANTED_ASSET = 2;
    UNSTABLE_ASSET = 3;
}

enum AssetType {
    ASSET_TYPE_DO_NOT_USE = 0;
    STOCK = 1;
}

enum UserAssetStatus {
    USER_ASSET_STATUS_DO_NOT_USE = 0;
    NOT_WHITELISTED = 1;
    WHITELISTING_REQUESTED = 2;
    WHITELISTED = 3;
    OUTDATED_VERSION = 4;
}
